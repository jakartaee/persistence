# Guide for maintainers of Jakarta Persistence

This guide is intended for maintainers of Jakarta Persistence,
i.e. anybody with direct push access to the git repository.

## Release

Release of a new Jakarta Persistence version should be coordinated 
across the following subdirectories of https://github.com/jakartaee/persistence:

- [api](api)
- [tck](tck)
- [spec](spec)

### Jakarta Persistence API release

This one **must** go first. The release job for Jakarta Persistence API
builds and publishes the Jakarta Persistence API artifacts
to Maven Central, updates version and tags the repository.
The build also produces a downloadable artifact containing the rendered javadocs. 

* Go to [Jakarta Persistence API Release job](https://ci.eclipse.org/jpa/job/jakarta-persistence-api-publish-release/)
* Pick the branch from which you are planing to perform a release.
    - Run the `Build with Parameters` and fill out the form
    - Publishing to Maven Central is automatic, so no extra steps are required at the moment.

### Jakarta Persistence TCK

Jakarta Persistence TCK is next on the list. The release job for this repository 
builds and publishes the Jakarta Persistence TCK artifacts
to Maven Central, uploads the distribution packages to Eclipse downloads server.
This job also updates and tags the repository.

* Update Jakarta Persistence API version in the POM dependencies (need to create a pull request for this one!)
* Go to [Jakarta Persistence TCK Release job](https://ci.eclipse.org/jpa/job/jakarta-persistence-tck-publish-release/)
* Pick the branch from which you are planing to perform a release.
    - Run the `Build with Parameters` and fill out the form
    - Publishing to Maven Central is automatic, so no extra steps are required at the moment.
- ### Jakarta Persistence Spec

Specification is "released" next. Release job for this repository does not actually publish the spec to the site
it only generated the build artifacts that have to be pulled locally and used to create a corresponding pull request.
This job also updates and tags the repository.

* Update the changelog and what's new specification section first.
* Go to [Jakarta Persistence Specification Release job](https://ci.eclipse.org/jpa/job/jakarta-persistence-spec-publish-release/)
* Pick the branch from which you are planing to perform a release.
    - Run the `Build with Parameters` and fill out the form
    - Once the build is complete, download the generated artifacts

### Jakarta Specifications update

The final step is to update the [specification repository](https://github.com/jakartaee/specifications).

* Create a pull request with the content generated by the specification release and javadocs from the API release
(e.g. https://github.com/jakartaee/specifications/pull/874)
* Make sure to update the index file to point to the new versions of downloadable TCK bundles
* Optionally, if the XSDs were updated or if it is the first release in the series, create a pull request to update the XSD
  following the instructions provided at https://jakartaee.github.io/platform/publish-xml-schemas

